## hybrid

- hybrid是客户端和前端的混合开发

- hybrid存在的核心意义在于快速迭代，无需审核

- hybrid实现流程，以及webview和file协议

![](/assets/618527831.jpg)



# Webview

- Webview是app中的一个组件(app可以有Webview，也可以没有)

- 用于加载h5页面，即一个小型的浏览器内核




# 两者区别

- file协议： 本地文件，快

- http(s)协议： 网络加载，慢



## 使用场景

- NA：体验要求极致，变化不频繁(如头条的首页)

- hybrid：体验要求高，变化频繁(如头条的详情页)

- h5：体验无要求，不常用(如举报、反馈等页面)



## 具体实现

- 前端将静态文件交给客户端

- 客户端拿到前端静态文件，以文件形式存储在app中

- 客户端在一个webview中，使用file协议加载静态页面



## 通过服务端更新hybrid文件



## hybrid和h5区别

- hybrid：产品的稳定功能，体验要求高，迭代频繁

- h5：单次的运营活动或不常用的功能

- 优点

    - 体验更好，跟NA体验基本一致

    - 可快速迭代，无需app审核【关键】
    
- 缺点

    - 开发成本高。联调、测试、查bug都比较麻烦
    
    - 运维成本高
    
    
    
## hybrid数据的获取

- 不能用ajax获取。第一，跨域；第二，速度慢。

- 客户端获取数据，然后JS通讯拿到内容，再渲染

    - js需要加载后发送请求获取，客户端可以提前获取。
    


## JS和客户端通讯的基本形式

- JS访问客户端能力，传递参数和回调函数

- 客户端通过回调函数返回内容



## schema协议：前端和客户端通讯的约定




## 内置上线

- 将invoke.js内置到客户端

- 客户端每次启动webview，都默认加载invoke.js

- 本地加载，免去网络加载的时间，更快。

- 没有网络请求，黑客看不到schema协议的封装，更安全。



## 前端JS如何和客户端通讯

- 通讯的基本形式：基本能力，传递参数，监听回调

- 对schema协议的理解和使用

- 调用schema代码的封装

- 内置上线的好处：更快、更安全


